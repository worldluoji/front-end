# SemVer
npm 在 package.json 声明依赖的时候，是以 KV 形式表示的。K 表示报名，V 则表示版本号。这里的“版本号”只是个代称，除了 SemVer 的版本号之外，还可以是路径等等内容：

一个 SemVer 版本号范围；
- URL；
- Git 地址；
- GitHub 下的 user/repo 形式；
- Tag 标签；
- 本地路径。

如：
```
{
  "dependencies": {
    "foo": "1.0.0 - 2.9999.9999",
    "bar": ">=1.0.2 <2.1.2",
    "baz": ">1.0.2 <=2.3.4",
    "boo": "2.0.1",
    "qux": "<1.0.0 || >=2.3.1 <2.4.5 || >=2.5.2 <3.0.0",
    "asd": "http://asdf.com/asdf.tar.gz",
    "til": "~1.2",
    "elf": "~1.2.3",
    "two": "2.x",
    "thr": "3.3.x",
    "lat": "latest",
    "dyl": "file:../dyl"
  }
}
```
规范的 SemVer 格式为：<主版本号>.<次版本号>.<修订号>-<先行版本号>+<构建号>。其中主版本号、次版本号和修订号必须是数字。先行版本号和构建号可以是字母、数字以及小数点 .，不过先行版本号是不可以有前导零的，构建号可以。

我们常见的在 SemVer 前面加上 ~、^ 等符号，就表示这是一个 SemVer 范围。下面不严谨地讲一下，更严谨的说明可参阅 node-semver 文档。

## 精确匹配
如果这个范围是 SemVer 本身，则需精确匹配特定版本。

## 大于、小于
如果前面是大于、小于等符号，则范围为字面意义上的范围：
```
<：小于某个版本；
<=：小于等于某个版本；
>：大于某个版本；
>=：大于等于某个版本；
=：精确匹配。
```

## 区间匹配
区间匹配为两个版本号之间加个 -，表示匹配的版本需要在区间中间。如 1.2.3 - 2.3.4 代表 >= 1.2.3 <= 2.3.4。

## 通配匹配
某一段单一个 *、x 和 X 可代表通配。比如 * 代表任意版本（>= 0.0.0）；1.x 代表 1 为主版本的任意版本（>= 1.0.0 < 2.0.0-0）；1.2.x 则代表 1.2 为主次版本的任意版本（>= 1.2.0 < 1.3.0-0）。其实这上面的通配是可忽略的，也就是说空字符串代表任意版本，1 等同于 1.x，1.2 等同于 1.2.x。

## 波浪匹配
波浪匹配和上箭头匹配是最常见的 SemVer 匹配范围表示了。波浪匹配不允许动主次版本号，以修订版本号为最低匹配版本号去匹配。如 ~1.2.3 则说明 >= 1.2.3 < 1.3.0-0；~1.2 则说明 >= 1.2.0 < 1.3.0-0，即等同于 1.2 或 1.2.x；~0.2 表示 >= 0.2.0 < 0.3.0-0。

波浪匹配有一个例外，就是若只指定了主版本号，则将版本限定为对应主版本号下的所有版本号。也就是说 ~0 表示 >= 0.0.0 < 1.0.0-0。

## 上箭头匹配
上箭头匹配表示第一个非零版本段后面的版本段可被升级。例如 ^1.2.3，第一个非零版本段是主版本号，它后面的版本段是次版本号，也就说可匹配大于该版本号的所有该主版本号下的版本号，即 >= 1.2.3 < 2.0.0-0；^0.2.3 的第一个非零是次版本号，也就是说可匹配该版本号的所有该次版本号下的版本号，即 >= 0.2.3 < 0.3.0-0。^0.0.3 只能匹配该修订号下所有先行版本号，即 >= 0.0.3 < 0.0.4-0。

既然讲到了先行版本号，那么可以再匹配下。^1.2.3-beta.2 代表 >= 1.2.3-beta.2 < 2.0.0-0；^0.0.3-beta.2 代表 >= 0.0.3-beta.2 < 0.0.4-0。所有不带先行版本号的 SemVer 版本都比对应版本加上任意先行版本号的 SemVer 版本大，即 1.0.0 是大于 1.0.0-<xxx> 的。