# APP登陆安全策略
## 登录状态

**一、使用加密技术**

1. 令牌（Token）加密
   - 当用户成功登录后，服务器返回一个加密的令牌给客户端。这个令牌可以包含用户的身份信息和一些权限标识等。客户端将令牌存储在本地，每次请求时携带令牌发送给服务器进行身份验证。
   - 为了提高安全性，令牌可以使用如 JSON Web Token（JWT）等标准进行加密。JWT 由三部分组成：头部（Header）、载荷（Payload）和签名（Signature）。头部包含令牌的类型和加密算法；载荷包含用户信息和其他声明；签名则是使用头部指定的加密算法对头部和载荷进行加密生成的，用于验证令牌的完整性和真实性。
   - 优点：令牌可以在一段时间内有效，减少了频繁登录的需求。同时，由于令牌是加密的，即使被窃取，攻击者也难以解读其中的内容。
   - 缺点：如果令牌的有效期设置过长，一旦被窃取，可能会被攻击者长时间利用。因此，需要合理设置令牌的有效期，并在必要时进行令牌的更新和撤销。

2. 存储加密
   - 对于一些需要在本地存储用户登录信息的情况，可以使用加密存储技术。例如，使用加密数据库或者对存储的数据进行加密后再保存。
   - 常见的加密算法有 AES（Advanced Encryption Standard）等。在存储用户登录信息之前，使用加密算法对信息进行加密，读取时再进行解密。
   - 优点：即使设备被物理访问或者数据被非法获取，攻击者也难以获取用户的登录信息。
   - 缺点：加密和解密过程会增加一定的系统开销，同时需要妥善管理加密密钥，防止密钥泄露。

**二、多因素认证**

1. 生物识别
   - 利用用户的生物特征进行登录状态的确认，如指纹识别、面部识别、虹膜识别等。当用户首次登录时，可以将生物特征与账号绑定。之后，在需要确认登录状态时，通过读取用户的生物特征进行验证。
   - 优点：生物特征具有唯一性和难以伪造性，提高了登录的安全性。
   - 缺点：生物识别技术可能受到环境因素（如光线、温度等）和用户自身状态（如手指受伤、面部变化等）的影响，导致识别失败。同时，生物识别数据的存储和传输也需要严格的安全措施。

2. 动态口令
   - 除了传统的用户名和密码登录外，结合动态口令进行登录状态的确认。动态口令可以通过硬件令牌、手机短信、专门的动态口令生成 APP 等方式生成。
   - 当用户登录后，服务器会与客户端同步一个动态口令生成算法。在一定时间间隔内，客户端和服务器根据相同的算法生成相同的动态口令。每次请求时，客户端需要提供当前的动态口令进行验证。
   - 优点：动态口令是不断变化的，即使攻击者窃取了一次口令，也无法在下次使用。
   - 缺点：用户需要额外携带硬件令牌或者确保手机能够接收短信等，增加了一定的使用成本。

**三、安全策略**

1. 超时自动退出
   - 设置登录状态的超时时间，当用户在一段时间内没有进行任何操作时，自动退出登录状态。这样可以防止用户在离开设备后，登录状态被他人利用。
   - 超时时间的设置需要根据具体的应用场景进行权衡，既要考虑用户的使用体验，又要保证安全性。
   - 优点：可以有效降低因用户疏忽而导致的安全风险。
   - 缺点：可能会给用户带来一些不便，特别是在一些需要长时间保持登录状态的场景下。

2. 设备绑定
   - 将用户的账号与特定的设备进行绑定，只有在绑定的设备上才能保持登录状态。当用户在其他设备上尝试登录时，需要进行额外的验证步骤。
   - 设备绑定可以通过多种方式实现，如记录设备的唯一标识（如设备序列号、MAC 地址等）、使用设备指纹技术等。
   - 优点：可以防止账号在未经授权的设备上被登录，提高了安全性。
   - 缺点：如果用户更换设备或者设备出现故障，可能需要进行繁琐的解绑和重新绑定操作。

3. 异常检测
   - 客户端和服务器可以通过监测用户的行为模式来检测异常情况。例如，如果发现用户的登录地点、登录时间、操作习惯等与平时有较大差异，可能存在账号被盗的风险，此时可以要求用户进行额外的验证或者自动退出登录状态。
   - 优点：可以及时发现潜在的安全问题，采取相应的措施保护用户账号安全。
   - 缺点：异常检测算法需要不断优化和调整，以避免误报和漏报的情况。

总之，为了确保客户端和 APP 中登录状态的安全保存，需要综合运用多种技术和策略，从加密、认证、安全策略等多个方面进行考虑，以提供更加安全可靠的用户体验。

<br>

## Cordova安全保存tokan
在基于 Cordova 的 APP 中，保存 Token 可以采用以下几种相对安全的方式：

**一、使用安全的本地存储**

1. Cordova Secure Storage 插件
   - Cordova 提供了一些安全存储的插件，其中 Cordova Secure Storage 是一个不错的选择。它使用设备的安全存储区域来保存数据，相比传统的本地存储更加安全。
   - 优点：提供加密存储功能，数据在存储时会进行加密处理，即使设备被攻击或数据被窃取，攻击者也难以获取到明文的 Token。同时，它还具有跨平台的特性，可以在不同的移动操作系统上使用。
   - 缺点：需要引入额外的插件，可能会增加一定的开发和维护成本。并且，依赖于插件的稳定性和安全性，如果插件存在漏洞，可能会影响 Token 的安全保存。

2. 使用 Keychain（iOS）和 Keystore（Android）
   - 在 iOS 平台上，可以使用 Keychain 来保存敏感信息，包括 Token。Keychain 提供了强大的加密和安全机制，可以确保数据的安全性。
   - 在 Android 平台上，可以使用 Keystore 来存储加密后的 Token。Keystore 允许应用将加密密钥存储在设备的安全硬件中，提供了更高的安全性。
   - 优点：利用操作系统提供的安全存储机制，具有较高的安全性和可靠性。同时，这些存储机制通常经过了严格的安全测试和验证。
   - 缺点：开发过程相对复杂，需要了解不同平台的安全存储机制和 API。并且，对于一些复杂的安全需求，可能需要进行更深入的配置和管理。

**二、避免不安全的存储方式**

1. 避免使用 localStorage 和 sessionStorage
   - 虽然 localStorage 和 sessionStorage 在 Web 开发中很常用，但在 Cordova APP 中，它们并不是最安全的存储方式。这些存储方式的数据以明文形式存储在设备上，容易被攻击者获取。
   - 此外，localStorage 和 sessionStorage 的存储容量有限，可能不适合存储较大的 Token 或其他敏感信息。

2. 不要将 Token 硬编码在代码中
   - 绝对不要将 Token 直接硬编码在应用的代码中，这是非常不安全的做法。一旦应用的代码被反编译，Token 就会暴露给攻击者。

**三、结合其他安全措施**

1. 定期更新 Token
   - 服务器可以定期生成新的 Token，并要求客户端进行更新。这样可以降低 Token 被窃取后长时间被利用的风险。
   - 客户端在接收到新的 Token 后，应及时更新本地存储中的 Token，并确保旧的 Token 被安全删除。

2. 结合多因素认证
   - 除了使用 Token 进行身份验证外，还可以结合其他的安全认证方式，如指纹识别、面部识别等。这样即使 Token 被窃取，攻击者也难以通过其他认证方式。

3. 加密通信
   - 确保客户端与服务器之间的通信是加密的，防止 Token 在传输过程中被窃取。可以使用 HTTPS 等安全通信协议来保证通信的安全性。

总之，在基于 Cordova 的 APP 中保存 Token 时，应选择安全的存储方式，并结合其他安全措施，以确保 Token 的安全性和应用的整体安全性。同时，开发人员还应密切关注安全领域的最新动态，及时更新和改进应用的安全机制。