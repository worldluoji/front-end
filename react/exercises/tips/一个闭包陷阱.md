# ä¸€ä¸ªé—­åŒ…é™·é˜±
```jsx
function Counter() {
  const [count, setCount] = useState(0);
  
  useEffect(() => {
    const timer = setInterval(() => {
      setCount(count + 1);
    }, 1000);
    return () => clearInterval(timer);
  }, []);
  
  return <div>{count}</div>;
}
```
è¿™æ®µä»£ç å­˜åœ¨ä¸€ä¸ªå…¸å‹çš„ **é—­åŒ…é™·é˜±**ï¼Œä¼šå¯¼è‡´è®¡æ—¶å™¨æ— æ³•æ­£ç¡®æ›´æ–° `count` å€¼ã€‚å…·ä½“é—®é¢˜å’Œä¿®å¤æ–¹æ¡ˆå¦‚ä¸‹ï¼š

---

### **é—®é¢˜åˆ†æ**
1. **ä¾èµ–æ•°ç»„ç¼ºå¤±**ï¼š  
   `useEffect` çš„ä¾èµ–æ•°ç»„ä¸ºç©ºï¼ˆ`[]`ï¼‰ï¼Œå¯¼è‡´å…¶å›è°ƒå‡½æ•°åªåœ¨ç»„ä»¶æŒ‚è½½æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œé—­åŒ…ä¸­æ•è·çš„ `count` å§‹ç»ˆæ˜¯åˆå§‹å€¼ **0**ã€‚

2. **å®šæ—¶å™¨é€»è¾‘ç¼ºé™·**ï¼š  
   å®šæ—¶å™¨ä¸­æ¯æ¬¡æ‰§è¡Œ `setCount(count + 1)` æ—¶ï¼Œ`count` çš„å€¼å§‹ç»ˆæ˜¯ **0**ï¼Œå®é™…å˜æˆï¼š  
   ```js
   setCount(0 + 1); // â†’ æ°¸è¿œæ˜¯ 1
   ```
   æœ€ç»ˆ `count` å€¼ä¼šä¸€ç›´æ˜¾ç¤ºä¸º **1**ï¼Œæ— æ³•é€’å¢ã€‚

---

### **é—®é¢˜æ¼”ç¤º**
```jsx
// æ‰§è¡Œæµç¨‹ï¼š
1. ç»„ä»¶æŒ‚è½½ â†’ useEffect æ‰§è¡Œ â†’ å®šæ—¶å™¨å¯åŠ¨ï¼Œé—­åŒ…æ•è· count = 0
2. æ¯éš”1ç§’æ‰§è¡Œ setCount(0 + 1) â†’ count = 1 è§¦å‘æ¸²æŸ“
3. æ–°æ¸²æŸ“ä¸­ï¼ŒuseEffect å› ä¾èµ–æ•°ç»„ä¸ºç©ºä¸å†æ‰§è¡Œ
4. åç»­æ‰€æœ‰å®šæ—¶å™¨çš„é—­åŒ…ä¸­çš„ count ä»ç„¶æ˜¯æ—§çš„ 0
```

---

### **ä¿®å¤æ–¹æ¡ˆ**

#### **æ–¹æ¡ˆ 1ï¼šä½¿ç”¨å‡½æ•°å¼æ›´æ–°ï¼ˆæ¨èï¼‰**
**åŸç†**ï¼šé€šè¿‡ `setCount(c => c + 1)`ï¼Œæ— éœ€ä¾èµ–å½“å‰é—­åŒ…ä¸­çš„ `count`ã€‚  
**ä¼˜ç‚¹**ï¼šå¯ä¿æŒä¾èµ–æ•°ç»„ä¸ºç©ºï¼Œå®šæ—¶å™¨ä¸éœ€è¦é‡å¤é”€æ¯/é‡å»ºã€‚  
**ä»£ç **ï¼š
```jsx
useEffect(() => {
  const timer = setInterval(() => {
    setCount(c => c + 1); // âœ… ä½¿ç”¨å‡½æ•°å¼æ›´æ–°
  }, 1000);
  return () => clearInterval(timer);
}, []); // ä¾èµ–æ•°ç»„ä¿æŒä¸ºç©º
```

---

#### **æ–¹æ¡ˆ 2ï¼šæ·»åŠ ä¾èµ–é¡¹ + æ¸…ç†å®šæ—¶å™¨**
**åŸç†**ï¼šå°† `count` æ·»åŠ åˆ°ä¾èµ–æ•°ç»„ï¼Œæ¯æ¬¡ `count` å˜åŒ–æ—¶é‡æ–°åˆ›å»ºå®šæ—¶å™¨ã€‚  
**ç¼ºç‚¹**ï¼šé¢‘ç¹é”€æ¯/é‡å»ºå®šæ—¶å™¨ï¼ˆè™½ç„¶ä¸ä¼šå¼•èµ·æ˜æ˜¾ Bugï¼Œä½†è®¾è®¡ä¸åˆç†ï¼‰ã€‚  
**ä»£ç **ï¼š
```jsx
useEffect(() => {
  const timer = setInterval(() => {
    setCount(count + 1); // ç›´æ¥ä½¿ç”¨æœ€æ–° count
  }, 1000);
  return () => clearInterval(timer); 
}, [count]); // âœ… æ·»åŠ  count åˆ°ä¾èµ–æ•°ç»„
```

---

#### **æ–¹æ¡ˆ 3ï¼šé€šè¿‡ useRef ä¿å­˜æœ€æ–°å€¼ï¼ˆæ›¿ä»£æ–¹æ¡ˆï¼‰**
**åŸç†**ï¼šä½¿ç”¨ `ref` åŒæ­¥æœ€æ–° `count` å€¼ï¼Œç»•è¿‡é—­åŒ…é™åˆ¶ã€‚  
**ä»£ç **ï¼š
```jsx
function Counter() {
  const [count, setCount] = useState(0);
  const countRef = useRef(count); 

  // åŒæ­¥æœ€æ–° count åˆ° ref
  useEffect(() => {
    countRef.current = count;
  }, [count]);

  useEffect(() => {
    const timer = setInterval(() => {
      setCount(countRef.current + 1); // âœ… é€šè¿‡ ref è·å–æœ€æ–°å€¼
    }, 1000);
    return () => clearInterval(timer);
  }, []);

  return <div>{count}</div>;
}
```

---

### **æ ¸å¿ƒé—®é¢˜æ€»ç»“**
| é”™è¯¯ç‚¹                  | åæœ                      | ä¿®å¤æ–¹æ³•                              |
|-------------------------|--------------------------|-------------------------------------|
| æœªæ·»åŠ ä¾èµ–é¡¹ `count`     | é—­åŒ…ä¸­ `count` å€¼å§‹ç»ˆä¸º 0  | ä½¿ç”¨å‡½æ•°å¼æ›´æ–°æˆ–æ·»åŠ  `count` åˆ°ä¾èµ–æ•°ç»„ |
| ç›´æ¥ä¾èµ–å¤–éƒ¨çŠ¶æ€å˜é‡     | é—­åŒ…è¿‡æ—¶çŠ¶æ€é—®é¢˜          | é€šè¿‡å‡½æ•°å¼æ›´æ–°æˆ– `ref` ç»•è¿‡é—­åŒ…       |

---

### **æœ€ä½³å®è·µ**
â€¢ **ä¼˜å…ˆä½¿ç”¨å‡½æ•°å¼æ›´æ–°**ï¼ˆæ–¹æ¡ˆ 1ï¼‰ï¼š
  ```js
  setCount(c => c + 1)
  ```
  æ— éœ€ç®¡ç†ä¾èµ–é¡¹ï¼Œä»£ç æ›´ç®€æ´ä¸”æ€§èƒ½æ›´ä¼˜ã€‚
  
â€¢ ä»…åœ¨éœ€è¦è®¿é—® **æœ€æ–° props/state** çš„éæ›´æ–°åœºæ™¯ä½¿ç”¨ `useRef`ï¼ˆå¦‚è®¿é—® DOM å…ƒç´ ï¼‰ã€‚

---

é€šè¿‡ä¸Šè¿°ä¿®å¤ï¼Œè®¡æ•°å™¨å°†èƒ½æ­£ç¡®æ¯ç§’é€’å¢ ğŸš€ã€‚