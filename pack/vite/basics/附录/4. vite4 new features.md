Vite 4 相对于 Vite 3 在多个方面进行了改进，主要包括性能提升、工具链更新、以及一些新特性的引入。以下是一些主要的改进点：

1. **性能优化**:
   - Vite 4.3 版本特别注重性能优化，显著提升了冷启动时间和热模块替换（HMR）的速度。
   - 对于 React 项目，当使用 `@vitejs/plugin-react-swc` 插件时，Vite 4.3 的冷启动时间比 Turbopack 快了 1.5 秒，热启动时间也有所提升。
   - 首次内容渲染的时间（FCP）从平均 38031 毫秒降低到了 3083 毫秒，大约快了 12 倍。

2. **工具链和构建工具更新**:
   - Vite 4 使用 SWC 替换了 Babel 作为默认的 JavaScript 转换工具，这不仅提高了构建速度，还减少了对额外依赖的需求。
   - 更新了内部使用的 esbuild 和 SWC 等工具到最新版本，以利用它们的性能优势。

3. **开发者体验改进**:
   - 改进了错误处理机制，移除了某些自定义错误，转而抛出原始错误来提高性能。
   - 重构了部分代码逻辑，简化了解析过程，尤其是在查找 package.json 和 TypeScript 配置文件时。
   - 引入了 `vite-plugin-warmup` 插件，该插件可以预热指定的文件，使得这些文件在首次请求时已经准备好，从而进一步加快开发服务器的响应速度。

4. **其他小改进**:
   - 优化了一些同步操作，减少了不必要的验证步骤，改善了路径检查等。
   - 对嵌套依赖项的解析做了简化，提高了 package.json 解析速度。
   - 修正了一些正则表达式的使用，确保它们能够被正确重用。

5. **兼容性与迁移**:
   - Vite 4 不再支持 Node.js v12，最低要求是 Node.js 14.18+ 或更高版本。
   - 提供了详细的迁移指南，帮助用户从 Vite 3 平滑过渡到 Vite 4。

